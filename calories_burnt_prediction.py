# -*- coding: utf-8 -*-
"""Calories Burnt Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1M0V7Qf_vlTN9D8Ue3vdCxAJfbKEgKlGt
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn import metrics
from xgboost import XGBRegressor

cdata=pd.read_csv('data.csv')

cdata.head()

exercise_data=pd.read_csv('exercise.csv')

exercise_data.head()

data=pd.concat([exercise_data,cdata['Calories']],axis=1)

data.head()

data.shape

data.isnull().sum()

data.info()

data.describe()

sns.set()

sns.countplot(x=data['Gender'])

sns.displot(x=data['Age'])

sns.displot(x=data['Height'])

sns.displot(x=data['Weight'])

correlation = data.select_dtypes(include=['number']).corr()

plt.figure(figsize=(10, 8))
sns.heatmap(correlation, cbar=True, square=True, fmt='.1f', annot=True, annot_kws={'size':8}, cmap='Blues')
plt.title('Correlation Heatmap')
plt.show()

data.replace({'Gender':{'male':0,'female':1}},inplace=True)

data.head()

X=data.drop(columns=["User_ID",'Calories'],axis=1)
Y=data['Calories']

print(X)

print(Y)

X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=2)

print(X.shape, X_train.shape, X_test.shape)

model=XGBRegressor()

model.fit(X_train,Y_train)

test_data_prediction=model.predict(X_test)

print(test_data_prediction)

MAE=metrics.mean_absolute_error(Y_test,test_data_prediction)

print("The mean absolute error is ",MAE)

